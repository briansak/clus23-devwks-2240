<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Creating Your First AWS Activity | DEVWKS-2240</title> <meta name="generator" content="Jekyll v4.3.2" /> <meta property="og:title" content="Creating Your First AWS Activity" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Using SecureX orchestration for Automating Public Cloud Incident Response" /> <meta property="og:description" content="Using SecureX orchestration for Automating Public Cloud Incident Response" /> <link rel="canonical" href="http://localhost:4000/first-activity/" /> <meta property="og:url" content="http://localhost:4000/first-activity/" /> <meta property="og:site_name" content="DEVWKS-2240" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Creating Your First AWS Activity" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Using SecureX orchestration for Automating Public Cloud Incident Response","headline":"Creating Your First AWS Activity","url":"http://localhost:4000/first-activity/"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/" class="site-title lh-tight"> DEVWKS-2240 </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/welcome/" class="nav-list-link">Welcome</a></li><li class="nav-list-item active"><a href="/first-activity/" class="nav-list-link active">Creating Your First AWS Activity</a></li><li class="nav-list-item"><a href="/import-workflow/" class="nav-list-link">Importing a Workflow From Github</a></li><li class="nav-list-item"><a href="/threat-response/" class="nav-list-link">Integration with SecureX threat response</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search DEVWKS-2240" aria-label="Search DEVWKS-2240" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h3 id="creating-your-first-aws-activity"> <a href="#creating-your-first-aws-activity" class="anchor-heading" aria-labelledby="creating-your-first-aws-activity"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Creating Your First AWS Activity </h3> <blockquote> <p><strong>SHARED ENVIRONMENT ALERT</strong> <br /> Make sure you uniquely name your workflow when creating!</p> </blockquote> <p>API Reference: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeInstances.html</p> <p>Create a new activity that will provide the details of an EC2 instance, following the example presented.</p> <ol> <li>Create a <strong>New Workflow</strong></li> </ol> <p><img width="1440" alt="newworkflow" src="https://user-images.githubusercontent.com/10421515/217500740-16af2de6-3530-4273-ad4a-fea908aac3a9.png" /></p> <ol> <li>From the activities tab, drag the <strong>AWS Service</strong> –&gt; <strong>Generic AWS API Request</strong> actiivity to the canvas.</li> </ol> <p><img width="1441" alt="awsactivity" src="https://user-images.githubusercontent.com/10421515/217501771-e2acfc9d-3e66-4637-89ca-b90b76dceeee.png" /></p> <ol> <li>Name the activity <strong>Query EC2 Instance</strong> in the activity Display Name and Override the workflow target with: <strong>AWS_Target</strong> in the activity properties.</li> </ol> <p><img width="1440" alt="image" src="https://user-images.githubusercontent.com/10421515/173708851-fde409ab-e0ae-43b1-b36a-f3e0054896ad.png" /></p> <ol> <li>Specify the URL near the bottom of the activity properties with:</li> </ol> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://ec2.us-east-1.amazonaws.com/?Action=DescribeInstances&amp;Filter.1.Name=private-ip-address&amp;Filter.1.Value=YOUR_POD_IP&amp;Version=2016-11-15
</code></pre></div></div> <p>Replacing “YOUR_POD_IP” with the IP address associated with your pod in the table below and set the API Method to <strong>GET</strong>.</p> <div class="table-wrapper"><table> <thead> <tr> <th> </th> <th> </th> </tr> </thead> <tbody> <tr> <td>Pod 1: 172.31.22.192</td> <td>Pod 11: 172.31.4.177</td> </tr> <tr> <td>Pod 2: 172.31.19.34</td> <td>Pod 12: 172.31.9.192</td> </tr> <tr> <td>Pod 3: 172.31.28.79</td> <td>Pod 13: 172.31.2.170</td> </tr> <tr> <td>Pod 4: 172.31.7.175</td> <td>Pod 14: 172.31.6.32</td> </tr> <tr> <td>Pod 5: 172.31.11.48</td> <td>Pod 15: 172.31.11.139</td> </tr> <tr> <td>Pod 6: 172.31.14.141</td> <td>Pod 16: 172.31.5.13</td> </tr> <tr> <td>Pod 7: 172.31.9.110</td> <td>Pod 17: 172.31.2.231</td> </tr> <tr> <td>Pod 8: 172.31.5.98</td> <td>Pod 18: 172.31.4.105</td> </tr> <tr> <td>Pod 9: 172.31.6.146</td> <td>Pod 19: 172.31.0.150</td> </tr> <tr> <td>Pod 10: 172.31.13.208</td> <td>Pod 20: 172.31.7.250</td> </tr> </tbody> </table></div> <p><img width="589" alt="image" src="https://user-images.githubusercontent.com/10421515/173710456-a0f3eff7-9b4a-4c71-8db8-505aeb3bb501.png" /></p> <ol> <li>Click on the “Start” element in the workflow and customize the workflow “Display Name” to <strong>Pod # - AWS Workflow</strong></li> </ol> <p><img width="1440" alt="workflow name" src="https://user-images.githubusercontent.com/10421515/217502201-fa637a5b-1653-41c9-83ac-ffa29bd894c1.png" /></p> <ol> <li>Validate and Run this workflow near the top of the canvas.</li> </ol> <p><img width="1440" alt="validate 1" src="https://user-images.githubusercontent.com/10421515/217502626-bd045e0a-58a5-40b5-a70d-5a75c3f0e940.png" /></p> <p>After running this activity, you should see the details of the instance that you queried in the output body.</p> <p><img width="1446" alt="first run" src="https://user-images.githubusercontent.com/10421515/217502274-97df6281-d8aa-49d3-80fe-6a09b24a9ced.png" /></p> <p>Click Modify to return to the Workflow Editor</p> <p><img width="1440" alt="modify" src="https://user-images.githubusercontent.com/10421515/217640516-705e2c51-4094-430d-8c4b-a4edc47ef845.png" /></p> <p>Next we will extract some data from the returned XML Response using an XPATH Activity.</p> <ol> <li>From the <strong>Core</strong> activites list grab and drag the <strong>XPATH Query</strong> and drag it to the canvas.</li> </ol> <p><img width="1440" alt="xpath" src="https://user-images.githubusercontent.com/10421515/217502908-aa6377d4-192e-4383-86fb-27d0dd0aa845.png" /></p> <ol> <li>Rename the activity <strong>Extract EC2 Details</strong></li> </ol> <p><img width="1440" alt="name xpath" src="https://user-images.githubusercontent.com/10421515/217505564-bdc29914-b961-4755-b7ea-a1b531494388.png" /></p> <ol> <li>Scroll down on the properties window and find where you will specify <strong>Source XML to Query</strong>. Click the puzzle piece in the upper-right corner to select a source.</li> </ol> <p><img width="1440" alt="xml query" src="https://user-images.githubusercontent.com/10421515/217503035-11e3b1d3-ca8c-418a-af54-4f3fe6a7d5d5.png" /></p> <ol> <li>Choose <strong>Activities –&gt; Query EC2 Instance –&gt; Body</strong> and choose <strong>Save</strong></li> </ol> <p><img width="1440" alt="image" src="https://user-images.githubusercontent.com/10421515/216678141-756823d2-5271-478b-9473-74489930d613.png" /></p> <ol> <li> <p>Click the <strong>”+”</strong> next to XPATH Query. Fill in the following details:</p> <p>Property Name: <strong>Instance ID</strong> <br /> XPath Query: <strong>//reservationSet/item/instancesSet/item/instanceId</strong> <br /> Property Type: <strong>String</strong> <br /></p> <p>Click the <strong>”+”</strong> again to add another variable.</p> <p>Property Name: <strong>Security Group</strong> <br /> XPath Query: <strong>//reservationSet/item/instancesSet/item/groupSet/item/groupName</strong> <br /> Property Type: <strong>String</strong> <br /></p> </li> </ol> <p>The properties should look like the graphic below.</p> <p><img width="1443" alt="xml query 3" src="https://user-images.githubusercontent.com/10421515/217504755-dcdfa1ce-f7f7-4aaf-86ee-d10882468ce9.png" /></p> <p>Next we’ll add a simple conditional block to check if one of our variables matches a specific value.</p> <ol> <li>Click on the <strong>Logic</strong> tab of the navigation, expand Logic and drag the <strong>Condition Block</strong> to the canvas.</li> </ol> <p><img width="1440" alt="1" src="https://user-images.githubusercontent.com/10421515/217505730-ba49c1ec-191a-49b5-b9a6-1bfeb3104f48.png" /></p> <ol> <li>Click on each of larger block and rename it <strong>Is Instance Isolated?</strong> and the smaller block on the left and name it <strong>Yes</strong>.</li> </ol> <p><img width="1440" alt="2" src="https://user-images.githubusercontent.com/10421515/217506053-aa65d08a-1e88-46c2-bbbd-53f3104eeb85.png" /></p> <ol> <li>Click on the <strong>Activities</strong> tab of the navigation, locate the <strong>Generic AWS API Request</strong> from the AWS Service section and drag it to the canvas into the <strong>Yes</strong> block.</li> </ol> <p><img width="1443" alt="3" src="https://user-images.githubusercontent.com/10421515/217506693-e9927e8c-2f74-4a30-8796-f8c0f7c8e537.png" /></p> <ol> <li>Change the activity name to <strong>Tag EC2 Instance</strong>.</li> </ol> <p><img width="1440" alt="4" src="https://user-images.githubusercontent.com/10421515/217506872-d8c606c8-73a7-4f05-a54d-d3370931a7f8.png" /></p> <ol> <li>In the properties of the Tag EC2 Instance, scroll down and supply the following details:</li> </ol> <p>Override Workflow Target to <strong>AWS_Target</strong>.</p> <p>Set the <strong>AWS API Request</strong> URL to the one below and the API Method to <strong>GET</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://ec2.amazonaws.com/?Action=CreateTags&amp;ResourceId.1=INSTANCE_ID&amp;Tag.1.Key=Isolated&amp;Tag.1.Value=&amp;Version=2016-11-15
</code></pre></div></div> <p><img width="1440" alt="5" src="https://user-images.githubusercontent.com/10421515/217512813-b0e3f9fb-b1c6-439a-96f3-c1c7fbbcdc6e.png" /></p> <ol> <li>Highlight the <strong>INSTANCE_ID</strong> in the URL string and click the puzzle piece in the upper-right of that field.</li> </ol> <p><img width="1441" alt="tag1" src="https://user-images.githubusercontent.com/10421515/217563952-29bb7057-b6ec-48e3-9733-c208b9777c26.png" /></p> <p>Choose <strong>Activities –&gt; Extract EC2 Details –&gt; XPath Queries –&gt; Instance ID</strong></p> <p><img width="618" alt="instanceid" src="https://user-images.githubusercontent.com/10421515/217561549-889d4f84-e1bc-4d09-b115-b91b1de7993e.png" /></p> <p>The resulting URL should show the variable name set as one of the parameters.</p> <p><img width="914" alt="awsapi1" src="https://user-images.githubusercontent.com/10421515/217562214-1225cb3f-cee0-426b-a1ec-152011028c85.png" /></p> <ol> <li>Since we only have one condition, you can delete the other conditional branch. By clicking on it, choosing the three dots, and choosing <strong>Delete</strong>.</li> </ol> <p><img width="1440" alt="delete" src="https://user-images.githubusercontent.com/10421515/217564957-25552a79-ca77-4ae1-bb58-819bfca78a70.png" /></p> <ol> <li>Click into the <strong>Yes</strong> conditional branch to set the test condition. Click on the puzzle piece in the <strong>Left Operand</strong> field.</li> </ol> <p><img width="1440" alt="Condition" src="https://user-images.githubusercontent.com/10421515/217514255-71b49128-a605-4413-9049-dbef399387db.png" /></p> <p>Choose <strong>Activities –&gt; Extract EC2 Details –&gt; XPath Queries –&gt; Security Group</strong></p> <p><img width="626" alt="rightoperand" src="https://user-images.githubusercontent.com/10421515/217514576-105996a9-d205-4b2f-9f03-896b5ef2c864.png" /></p> <p>Then specify <strong>Isolate_SG</strong> as the <strong>Right Operand</strong>. When completed, it should look like the graphic below.</p> <p><img width="1440" alt="conditional 2" src="https://user-images.githubusercontent.com/10421515/217514942-195e73fb-eec6-4039-a0a7-8fb67a1d338c.png" /></p> <ol> <li>Click <strong>Validate</strong> again at the top of the window and run the workflow again.</li> </ol> <p><img width="1440" alt="validate 2" src="https://user-images.githubusercontent.com/10421515/217512954-05529e9c-46f7-4cc4-b286-e3f708d35a7c.png" /></p> <p>When the workflow runs this time you’ll be able to see the output of the second activity that parses the XML response from the first activity and extracts the name of the Instance and assigend Security Group for your EC2 instance. You’ll notice that the conditional block doesn’t trigger since the condition we specified doesn’t match.</p> <p><img width="1440" alt="second run" src="https://user-images.githubusercontent.com/10421515/217569404-44666d5d-c6cc-479e-b24b-7b64f3e059d5.png" /></p> <p>We will revisit this created workflow later after we initiate our completed incident response workflow.</p> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
